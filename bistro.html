<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Bistro</title>
    <style>
      body {
        margin: 1em;
        margin-left: 12em;
        margin-right: 12em;
      }
      ul {
        text-align: center;
      }

      .valgt {
        background-color: blue;
      }

      article {
        border: 1px solid #333;
        border-radius: 25px;
        padding: 10px;
        margin: 1em;
      }

      img {
        max-width: 100%;
      }

      .data_container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
      }
    </style>
  </head>

  <header>
    <h2>Alle</h2>
    <nav>
      <ul>
        <button data-kategori="alle" class="valgt">Alle</button>
        <button data-kategori="forretter">Forretter</button>
        <button data-kategori="hovedretter">Hovedretter</button>
        <button data-kategori="desserter">Desserter</button>
        <button data-kategori="drikkevarer">Drikkevarer</button>
      </ul>
    </nav>
  </header>

  <body>
    <section class="data_container"></section>

    <template>
      <article>
        <img src="" alt="" />
        <h3></h3>

        <p class="kortbeskrivelse"></p>
        <p class="pris"></p>
      </article>
    </template>
    <script>
      const url = "https://babushka-dd8a.restdb.io/rest/menu";

      const options = {
        headers: {
          "x-apikey": "600ec2fb1346a1524ff12de4",
        },
      };

      document.addEventListener("DOMContentLoaded", start);
      let madretter;
      let container;
      let temp;
      let filter = "alle";
      const header = document.querySelector("header h2");

      function start() {
        container = document.querySelector(".data_container");
        temp = document.querySelector("template");

        const filterKnapper = document.querySelectorAll("nav button");
        filterKnapper.forEach((knap) =>
          knap.addEventListener("click", filtrerMadretter)
        );
        hentData();
      }

      function filtrerMadretter() {
        filter = this.dataset.kategori;
        document.querySelector(".valgt").classList.remove("valgt");
        this.classList.add("valgt");

        visMad();
        header.textContent = this.textContent;
      }

      async function hentData() {
        const resspons = await fetch(url, options);
        madretter = await resspons.json();
        console.log(madretter);
        visMad();
      }

      function visMad() {
        container.textContent = "";

        madretter.forEach((madret) => {
          if (filter == madret.kategori || filter == "alle") {
            const klon = temp.cloneNode(true).content;
            const md = "-md.jpg";
            klon.querySelector("img").src =
              "billeder/" + madret.billednavn + md;
            klon.querySelector("h3").textContent = madret.navn;
            klon.querySelector(".kortbeskrivelse").textContent =
              madret.kortbeskrivelse;
            klon.querySelector(".pris").textContent =
              "Pris: " + madret.pris + ",-";
            container.appendChild(klon);
          }
        });
      }

      hentData();
    </script>
  </body>
</html>
